clc; close all; clear all;
 
tic
NumOfVars=15; % Number of sources (stacks)
NumOfObj=2; % Number of Objectives (least squares/bias/)
NumOfCons=0; 
NFE=5e3; %the number of objective function evaluations, defines how many times
%  the Borg MOEA can invoke objectiveFcn.  Once the NFE limit is reached, the
%  algorithm terminates and returns the result. 
eps=[0.5e-3 0.5e-3];
 
VarMeans=[1000 1500 600 1900 300]; % annual mean values of the stacks
VarLB=[0*VarMeans ones(1,10)*10]; % the lower bounds of the decision variables
VarUB=[3*VarMeans ones(1,10)*600]; % the upper bounds of the decision variables
% @idit_objective_func_1 @idit_objective_func_2
[vars, objs, runtime] = borg(NumOfVars, NumOfObj, NumOfCons, @idit_objective_func_2, NFE, eps, VarLB, VarUB);
toc

% look at results
% (two objectives are not conflicting as far as I understand). 

% scatter
scatter(objs(:,1),objs(:,2))

% sources locations
sourceLocations(1,:) = [20, 300]; %first column X location, second column Y location
sourceLocations(2,:) = [50,470];
sourceLocations(3,:) = [70,60];
sourceLocations(4,:) = [110,250];
sourceLocations(5,:) = [160,520];

% for each vars solution, display sensors+sources locations and values and mean_PED 
for i=1:size(vars,1)
    close all
    figure 
[~,c] = contour(field,'ShowText','on');
c.LineWidth = lw;
set(gca,'XTick',0:5:boundery/10,'XTickLabel',0:50:boundery)
set(gca,'YTick',0:5:boundery/10,'YTickLabel',0:50:boundery)
colorbar
hold on
plot(meshgrid(0:1:boundery/10,0:1:boundery/10),'k+','MarkerSize',0.5)
    pause
end

reshape(vars(1,6:end),[5 2])




% Present the map of dispersion
field = reshape(sensorArray(:,3),size(X));
lw = 2.5;
idit_plotDispersionMap(field, lw, boundery)


